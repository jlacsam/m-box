<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>m.box Library</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/library.css' %}">
    <link rel="stylesheet" href="{% static 'css/datatables.min.css' %}">
    <link rel="icon" href="{% static 'favicon.ico' %}">
</head>
<body>
    <div id="header" class="header">
        <span class="logo">m-box</span>
        <span class="title-bar"><table id="title-bar"><tr>
            <td><table id="menu-bar"><tr>
                <td id="videos-tab" onclick="goToVideos()">Videos</td>
                <td id="audios-tab" onclick="goToAudios()">Audios</td>
                <td id="photos-tab" onclick="goToPhotos()">Photos</td>
                <td id="documents-tab" onclick="goToDocs()">Documents</td>
                <td id="faces-tab" onclick="goToFaces()">Faces</td>
                <td id="voices-tab" onclick="goToVoices()">Voices</td>
                <td id="menu-separator">&nbsp;</td>
                <td id="library-tab">Library</td>
                <td id="reports-tab" onclick="goToReports()">Reports</td>
                </tr></table></td>
            <td id="filler-space"></td>
            <td><table id="tool-bar"><tr>
                <td id="username">Hi {{ user.username }}!</td>
                <td id="profile">&#x1F466</td>
                <td id="settings">&#x2699</td></tr></table></td>
            </tr>
            </table>
        </span>
    </div>
    <div id="popup-menu" class="popup-hidden">
        <div id="user-groups">Editing allowed</div>
        <div><hr></div>
        <div class="menu-item"><a href="/logout/">Sign out</a></div>
    </div>
    <div id="settings-menu" class="popup-hidden">
        <ul id="max-rows-options">
            <li id="li-100" onclick="setMaxRows(100)">Max rows: 100</li> 
            <li id="li-250" onclick="setMaxRows(250)">Max rows: 250</li> 
            <li id="li-500" onclick="setMaxRows(500)">Max rows: 500</li> 
            <li id="li-1000" onclick="setMaxRows(1000)">Max rows: 1000</li> 
        </ul>
    </div>

    <div class="container">
    <table class="library-body">
      <tr>
      <td class="folder-section">
          <button id="btn-new-folder" class="control-button" onclick="createFolder()">New Folder</button>
          <div id="folder-list" class="folder-list"></div>
      </td>
      <td class="files-section">
        <div class="search-container">
            <input id="search-box" type="search" class="search" placeholder="[Search assets]">
            <p>&nbsp</p>
            <button id="search-button" class="button">&#128269;Search</button>
            <button id="reset-button" class="button">Reset</button>
        </div>
    
        <div class="controls">
            <table><tr>
                <td>
                    <span id="results-label">Showing records in</span>
                    <span id="bread-crumbs">[all folders]</span>
                </td>
                <td class="control-buttons">
                    <div id="context-buttons" class="context-buttons">
                        <button id="btn-rename" class="control-button">Rename</button>
                        <button id="btn-move" class="control-button">Move</button>
                        <button id="btn-set-owner" class="control-button">Set Owner</button>
                        <button id="btn-set-group" class="control-button">Set Group</button>
                        <button id="btn-set-access" class="control-button">Set Access</button>
                        <button id="btn-delete" class="control-button">Delete</button>
                        <button id="btn-configure" class="control-button">Configure</button>
                    </div>
                    <button id="btn-refresh" class="refresh-button" 
                        onclick="browseFolder(currentFolderID)">&#x1F5D8;</button>
                    <button id="column-filter-button"></button>
                    <label class="switch">
                        <input type="checkbox" id="toggleViewBtn">
                        <span class="slider-tile"></span>
                    </label>
                </td>
            </tr></table>
        </div> 
        <div id="results">
            <table id="results-table">
                <thead>
                    <tr> <!-- 22 columns -->
                        <th><div class="select-cell"><input type="checkbox" id="select-all">ID</div></th>
                        <th>Thumbnail</th>
                        <th>Name</th>
                        <th>File Type</th>
                        <th>Media Source</th>
                        <th>Size</th>
                        <th>Date Created</th>
                        <th>Date Uploaded</th>
                        <th>Last Accessed</th>
                        <th>Last Modified</th>
                        <th>Owner Name</th>
                        <th>Group Name</th>
                        <th>Access Rights</th>
                        <th>Remarks</th>
                        <th>Version</th>
                        <th>File Attributes</th>
                        <th>Other Metadata</th>
                        <th>IP Location</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="results-body">
                    <!-- Results will be populated here -->
                </tbody>
            </table>
        </div>
        <div id="tiles-results" style="display: none;"></div>

      </td></tr></table>
    </div>

    <div id="folder-browser" class='folder-browser-hidden'>
    </div>

    <div class="upload-button-div">
        <button id="upload-button" class="upload-button">&#xFF0B</button>
    </div>

    <div id="editor-div" class="editor-hidden">
        <textarea id="editor-textarea" type="text" name="editor">&nbsp;</textarea>
        <div id="editor-buttons">
            <button id="editor-ok" class="editor-button" onclick="saveEdits()">&#x2713</button>
            <button id="editor-cancel" class="editor-button" onclick="cancelEdits()">&#x10102</button>
        </div>
    </div>

    <dialog id="key-value-dialog" class="dialog-key-value">
        <div class="dialog-header">New Key-Value Pair
            <button type="button" id="cancel-dialog" class="modal-btn modal-btn-close">X</button>
        </div>
        <form id="key-value-form" method="dialog">
            <label for="keyInput" class="dialog-key-label">Key</label>
            <input type="text" id="keyInput" name="key" required>
            <label for="valueInput" class="dialog-value-label">Value</label>
            <textarea type="text" id="valueInput" name="value" required>&nbsp;</textarea>
            <div class="dialog-footer">
                <span id="dialog-message" class="dialog-message">&nbsp;</span>
                <button type="submit" class="dialog-submit-button" onclick="submitKeyValue(event)">Submit</button>
            </div>
        </form>
    </dialog>

    <dialog id="cf-configure-folder">
        <div class="cf-modal-content">
          <div class="cf-modal-header">
            <div class="cf-modal-title">
              <h2>Configure Folder</h2>
              <p class="cf-subtitle">FOLDER NAME</p>
            </div>
            <button class="cf-close-btn" formmethod="dialog">&times;</button>
          </div>
          <table class="cf-json-table">
            <thead>
              <tr>
                <th class="cf-json-td-cb">&nbsp;</th>
                <th class="cf-json-td-keys">Keys</th>
                <th class="cf-json-td-required">Required</th>
                <th class="cf-json-td-data-type">Data Type</th>
                <th class="cf-json-td-values">Validation REGEX</th>
              </tr>
            </thead>
            <tbody id="cf-json-body">
            </tbody>
          </table>
          <div class="cf-modal-actions">
            <div class="cf-action-buttons">
              <button class="cf-add-btn" type="button">+</button>
              <button class="cf-delete-btn" type="button">&#x2212</button>
            </div>
          </div>
          <div class="cf-modal-footer">
            <span class="cf-inherit-span">
              <input type="checkbox" id="cf-inherit">
              <label for="cf-inherit" class="cf-inherit-label">Enable folder contents to inherit the above metadata.</label>
            </span>
            <button class="cf-ok-btn" type="button">OK</button>
          </div>
        </div>
    </dialog>

    <script>
        const q_is_editor = ('{{ is_editor}}' === 'True');
        const q_is_supervisor = ('{{ is_supervisor }}' === 'True');
        const q_file_id = '{{ file_id }}'; 
        const q_file_name = '{{ file_name }}';
        const q_allow_edit = ('{{ allow_edit }}' === 'True');
    </script>
    <script src="{% static 'js/utils.js' %}"></script>
    <script src="{% static 'js/datatables.min.js' %}"></script>
    <script src="{% static 'js/library.js' %}"></script>
</body>
</html>
